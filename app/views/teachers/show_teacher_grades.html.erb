<% if @all_grades == NIL %>
  <h3 class="alert alert-danger">Permission Denied: pristupujete ku známkam iného žiaka.</h3>
<% else %>
  <div class="row">
    <div class="col-lg-4 pt-3 pl-5 pr-5 bg-light height-max">
      <h1 class="display-4">
        Výpis udeľených známok
      </h1>
      <p class="text-muted">Prehľad známok jednotlivých predmetov.</p>
      <hr>
      <h6>Pridaj známku</h6>

      <%= render 'add_grade_form', grade: @all_grades %>

      <hr>
      <h6>Filter</h6>
      <div class="form-group">
        <label for="filter-class">Filtrovať podľa triedy:</label>
        <select name="filter-class" class="form-control">
          <option value="0">Vyber...</option>
          <% @all_classes.each do |trieda| %>
            <option value="<%= trieda.fetch('id') %>"><%= trieda.fetch('name') %></option>
          <% end %>
        </select>
      </div>
      <div class="form-group">
        <label for="filter-student">Filtrovať podľa žiaka:</label>
        <select name="filter-student" class="form-control">
          <option value="0">Vyber...</option>
          <% @all_students.each do |student| %>
            <option value="<%= student.fetch('id') %>"><%= student.fetch('name') %></option>
          <% end %>
        </select>
      </div>
    </div>
    <div class="col-lg-8 pt-3 pr-5 height-max">
      <div style="margin-bottom: 10px; text-align: right">
        <button class="btn btn-success" id="btnExport">Exportovať</button>
      </div>
      <table class="table table-sm" id="tableWrapper">
        <thead class="thead-red">
        <tr>
          <th scope="col">Žiak</th>
          <th scope="col">Trieda</th>
          <th scope="col">Predmet</th>
          <th scope="col">Znamka</th>
          <th scope="col">Dátum</th>
          <th scope="col">Akcia</th>
        </tr>
        </thead>
        <tbody>
        <% @all_grades.each do |znamky| %>
          <tr>
            <th scope="row"><%= znamky.fetch('stname') %></th>
            <td><%= znamky.fetch('trname') %></td>
            <td><%= znamky.fetch('prname') %></td>
            <td><%= znamky.fetch('znamka') %></td>
            <td><%= znamky.fetch('datum') %></td>
            <%znamky[:grade_id]=znamky.fetch('grade_id').to_i%>
            <td><%= link_to 'Edit',znamky_edit_path(znamky),class: "btn btn-warning" %></td>
          </tr>
        <% end %>
        </tbody>
      </table>
    </div>
  </div>
<% end %>

